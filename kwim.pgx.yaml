---
+grammar: kwim
+toprule: document
+version: 0.0.1
block_blank:
  .ref: line_blank
block_comment:
  .rgx: \#\#\#\r?\n((?:.*?\r?\n)*?)\#\#\#\r?\n(?:\ *\r?\n)?
block_head:
  .rgx: (={1,4})\ +(?:(.+?)\ +=+\r?\n|(.+\r?\n(?:[^\s].*\r?\n)*[^\s].*?)\ +=+\r?\n|(.+\r?\n(?:[^\s].*\r?\n)*)(?=[\
    \*=\#]|\r?\n|\z))(?:\ *\r?\n)?
block_list:
  .rgx: (\*\ .*\r?\n(?:\*\ .*\r?\n|(?:\ *\r?\n)*\ \ .*\r?\n)*(?:\ *\r?\n)?)
block_para:
  .rgx: ((?:[^\ \*=\#\n].*?\r?\n)+)(?:\ *\r?\n)?
block_pref:
  .rgx: ((?:(?:\ *\r?\n)*\ \ .*\r?\n)+)(?:\ *\r?\n)?
block_title:
  .rgx: ((?:[^\ \*=\#\n].*?\r?\n))={3,}\r?\n(?:\ *\r?\n)?
block_top:
  .any:
  - .ref: block_blank
  - .ref: block_comment
  - .ref: line_comment
  - .ref: block_head
  - .ref: block_pref
  - .ref: block_list
  - .ref: block_title
  - .ref: block_verse
  - .ref: block_para
block_verse:
  .rgx: \.\r?\n((?:[^\ \*=\#\n].*?\r?\n)+)(?:\ *\r?\n)?
document:
  +min: 0
  .ref: block_top
line_blank:
  .rgx: (?:\ *\r?\n)
line_comment:
  .rgx: \#\ ?(.*?)\r?\n(?:\ *\r?\n)?
